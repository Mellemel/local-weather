"use strict";!function t(e,n,r){function i(s,h){if(!n[s]){if(!e[s]){var a="function"==typeof require&&require;if(!h&&a)return a(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return i(n?n:t)},c,c.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){function r(t){this.location=t.location,this.currentWeather=t.currentWeather,this.forecast=t.forecast,this.unit="F",this.unitChange=new s(this)}function i(t,e){this._model=t,this._elements=e,this.unitButtonClicked=new s(this);var n=this;this._model.unitChange.attach(function(){n.convertUnits()})}function o(t,e){this._model=t,this._view=e;var n=this;this._view.unitButtonClicked.attach(function(){n.convertUnit()})}function s(t){this._sender=t,this._listeners=[]}r.prototype={toCelsius:function(t){return Math.round(5*(t-32)/9)},toFahrenheit:function(t){return Math.round(9*t/5+32)},convertUnit:function(){var t=this;"F"===this.unit?(this.currentWeather.temp=this.toCelsius(this.currentWeather.temp),this.forecast.forEach(function(e){e.high=t.toCelsius(e.high),e.low=t.toCelsius(e.low)}),this.unit="C",this.unitChange.notify()):(this.currentWeather.temp=this.toFahrenheit(this.currentWeather.temp),this.forecast.forEach(function(e){e.high=t.toFahrenheit(e.high),e.low=t.toFahrenheit(e.low)}),this.unit="F",this.unitChange.notify())}},i.prototype={show:function(){var t=this._elements.location,e=this._elements.currentWeather,n=this._elements.forecast,r=this._model;return t.html(r.location.city+", "+r.location.region),e.html("<h3>"+r.currentWeather.date+'</h3><h1><span id="todayWeather">'+r.currentWeather.temp+'</span>&deg;<button id="button" class="unit btn btn-primary">F</button></h1><h3>'+r.currentWeather.text+"</h3>"),n.html(function(t){return"<td>"+r.forecast[t].day+"</td><td>"+r.forecast[t].date+'</td><td><span class="hweather">'+r.forecast[t].high+'</span>&deg;<span class="unit">F</span></td><td><span class="lweather">'+r.forecast[t].low+'</span>&deg;<span class="unit">F</span></td><td>'+r.forecast[t].text+"</td>"}),this},init:function(){this._elements.button=$("#button"),this._elements.unit=$(".unit"),this._elements.todayWeather=$("#todayWeather"),this._elements.highWeather=$(".hweather"),this._elements.lowWeather=$(".lweather");var t=this;this._elements.button.click(function(){t.unitButtonClicked.notify()})},convertUnits:function(){var t=this;this._elements.unit.text(this._model.unit),this._elements.todayWeather.text(this._model.currentWeather.temp),this._elements.highWeather.text(function(e){return t._model.forecast[e].high}),this._elements.lowWeather.text(function(e){return t._model.forecast[e].low})}},o.prototype={convertUnit:function(){this._model.convertUnit()}},s.prototype={attach:function(t){this._listeners.push(t)},notify:function(t){for(var e=0;e<this._listeners.length;e++)this._listeners[e](this._sender,t)}},e.exports={Model:r,View:i,Ctrl:o}},{}],2:[function(t,e,n){var r=t("./weather.js");$(document).ready(function(){var t={url:"https://api.ipify.org",format:"?format=json"};$.get(t.url+t.format,function(t){function e(t){var e={weekday:"short",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"};t.currentWeather.date=new Date(t.currentWeather.date).toLocaleTimeString("en-us",e).replace(/,\s/g,"-"),t.currentWeather.temp=parseInt(t.currentWeather.temp),t.forecast.forEach(function(t){t.high=parseInt(t.high),t.low=parseInt(t.low)})}var n={url:"https://freegeoip.net/",format:"json/",ip:t.ip};$.getJSON(n.url+n.format+n.ip,function(t){var n=t.city,i=t.region_code;/the/gi.test(n)&&(n=n.split(" ")[1]);var o={url:"http://query.yahooapis.com/v1/public/yql?q=",query:encodeURI('select * from weather.forecast where woeid in (select woeid from geo.places(1) where text="'+n+", "+i+'")'),setting:"&format=json&env=store%3A%2F%2Fdatatables.org%2Falltableswithkeys"};$.getJSON(o.url+o.query+o.setting).then(function(t){var n={location:t.query.results.channel.location,currentWeather:t.query.results.channel.item.condition,forecast:t.query.results.channel.item.forecast};e(n);var i=new r.Model(n),o=new r.View(i,{location:$("#location"),currentWeather:$("#today"),forecast:$(".day")});new r.Ctrl(i,o);o.show().init()})})})})},{"./weather.js":1}]},{},[2]);
//# sourceMappingURL=app.js.map
